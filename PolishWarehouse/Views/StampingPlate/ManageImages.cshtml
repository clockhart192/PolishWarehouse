@model PolishWarehouse.Models.StampingPlateImageModel[]
@if (Request.IsAuthenticated)
{
    ViewBag.Title = "Manage Images";

    @Html.Partial("MessageControl")

    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Manage Images for <a href="@Url.Action("Details",ViewBag.RedirectController, new { id = Model[0].StampingPlateID })">@ViewBag.Name</a></h3>
                </div>
                <div class="panel-body">
                    @foreach (var image in Model)
                    {
                        using (Html.BeginForm("ImageDetails", "Polish", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="ID" value="@image.ID">
                            <input type="hidden" name="StampingPlateID" value="@image.StampingPlateID">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                        </div>
                                        <div class="panel-body">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <img src="@image.ImageForHTML" class="img-polish-display" alt="image" />
                                                </div>
                                                <div class="col-md-8">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <label for="Description">Description</label>
                                                            <br />
                                                            <textarea class="form-control" rows="5" name="Description" placeholder="Description">@image.Description</textarea>
                                                        </div>
                                                    </div>
                                                    <div class="row hidden">
                                                        <div class="col-md-12">
                                                            <label for="Notes">Notes</label>
                                                            <br />
                                                            <textarea class="form-control" rows="5" name="Notes" placeholder="Notes">@image.Notes</textarea>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <label for="PublicImage">Public</label>
                                                            <br />
                                                            <label class="switch">
                                                                <input name="PublicImage" value="true" type="checkbox" @(image.PublicImage ? "checked" : "")>
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <label for="DisplayImage">Primary Display Image For This Polish</label>
                                                            <br />
                                                            <label class="switch">
                                                                <input name="DisplayImage" value="true" type="checkbox" @(image.DisplayImage ? "checked" : "")>
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4 text-center">
                                                    <input type="submit" class="btn btn-default" value="Save Image" />
                                                </div>
                                                <div class="col-md-8">
                                                    <label for="MakerImage">Change Image</label>
                                                    <br />
                                                    <div class="input-group">
                                                        <span class="input-group-btn">
                                                            <span class="btn btn-primary btn-file">Browse&nbsp;&nbsp;<span class="glyphicon glyphicon-search"></span><input type="file" name="file" id="file" /></span>
                                                        </span>
                                                        <input class="form-control file_display" type="text" readonly="">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
        }
    }
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
            $("#header-main-text").text("Stamping Plate");
        });
        $(document).on('change', '.btn-file :file', function () {
            var input = $(this),
            numFiles = input.get(0).files ? input.get(0).files.length : 1,
            label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
            //$('#file_display').val(label);
            $(this).parent().parent().parent().find("input[type=text]").val(label);
        });
    </script>
    }
    else
    {
        //TempData["Errors"] = "Please Log in.";
        Response.Redirect("~/Account/Login");
    }
